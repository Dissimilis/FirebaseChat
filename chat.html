<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<script src="https://cdn.firebase.com/js/client/2.2.1/firebase.js" integrity="sha384-zAlH3FrzsxdG1VfzWcyO9+PqCx5mQkLQPjgtp7jukmrbywGDj5nCivAb4j9ddOFu" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.slim.js" integrity="sha256-DrT5NfxfbHvMHux31Lkhxg42LY6of8TaYyK50jnxRnM=" crossorigin="anonymous"></script>
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap-theme.min.css" integrity="sha256-8uHMIn1ru0GS5KO+zf7Zccf8Uw12IA5DrdEcmMuWLFM=" crossorigin="anonymous" />
		<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.2/styles/tomorrow-night.min.css" integrity="sha256-j9z54bBKr1YuuulDV9S89E6WbTjElOrGGWyJy3N0xS8=" crossorigin="anonymous" />
		<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.2/highlight.min.js" integrity="sha256-xBWd+VDTBasaTja2bfaCX4aA2H18UxRsjRFkK3rgfkI=" crossorigin="anonymous"></script>
		<style>
		/*@import "https://fonts.googleapis.com/css?family=Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400";*/
			body { 
				background: black;
				font-family: Arial,sans-serif;
				font-weight: normal;
				font-size: 1.6em;
				line-height: 1.6;
				margin-bottom: 0.75em;
				text-rendering: optimizelegibility;
			 }
			.container-fluid {
				padding-right: 0px;
				padding-left: 0px;
				margin-right: auto;
				margin-left: auto;
			}
			#secureIcon	{
				position:fixed;
				top: 5px;
				right: 25px;		
			}
			.row {
				color: gray;
				width: 95%;
				margin: auto;
				background: #303030;				
			}
			#inputs-container {
				position: fixed;
				bottom: 0px;
				width: 100%;
				background: black;
				overflow: hidden;
				min-height: 100px;
			}
			#inputs { padding: 0.4em; }
			#messages {
				position: fixed;
				top: 0px;
				width: 100%;
				height: 100%;
				overflow: auto; 
				padding-bottom:132px;
			}
			.msg pre { margin-top:5px; padding:0; }
			.msg.row.same {	border-radius: 0; }
			.msg.row.alternate { background: #121212; }
			.msg.row.alternate.same { border-radius: 0; }
			.msg { padding-left: 0.2em;	}
			.msg.new { margin-top: 0.2em; }
			.msg.enc { border-right: 1px solid green; }
			.msg.new .nickname {
				width: auto;
				float: right;
			}
			.msg.same .nickname { display:none; }
			.msg .nickname { display: inline-block; }
			.msg .msgBody {
				color: #e6e1dc;
				padding-left: 0.2em;
				display: inline-block;
			}
			.msg code.snip
			{
				background:#969696;
				color:#126528;			
			}
			.msg .msgBody img
			{
				max-height:300px;
				width:auto;
				border: 1px solid black;	
				margin: 5px;				
			}
			.msg .time {
				color:#637763;
				font-size: 10px;
				margin:0;
			}
			.col-md-1 { width: auto; }
			img {
				padding: 0 0 0 0;
				max-width: 100%;
				max-height: 100%;
			}
			@-moz-document url-prefix() {
			img { width: 100%; height: 100%; }
			}
			input, button, select, textarea {
				border-radius: 0.2em;
				background: #cdc7c7;
			}
			button { margin-top: 0.2em; }
			#inputs input { margin-bottom: 0.4em; }
			#inputs textarea { min-width: 10em; width: 100%; height:82px; }
			#messages .alternate .msgBody { background: #121212; }
			#options span { color:gray;}
			#cryptoStatus {
				display: none;
				color: #f0b35a;
				margin-bottom: 0.4em;
				font-size: 0.8em;
			}
			#optionsToggle {right: 15px; position:fixed; color:white; cursor: pointer;}
			#send { font-size:10px;margin:0; border:0; line-height:12px; }
			hr { margin: 3px; }
		</style>
		<title>Chat</title>
	</head>
  <body>
    <div class="container-fluid">	
    <div id="messages"></div>
	<div id="inputs-container">
	<div id="inputs">		
	<div id="options" style="display: none">	
		<input value="" id="nameInput" placeholder="Name" type="text">
		<span id="notificationsConfig">
		<input value="" type="password" id="passwordInput" placeholder="Encryption password">	
		<button id="persistPass" title="Persist encryption key to survive refresh">#</button>
		<input type="checkbox" id="enableEncryption"> <label> Enable encryption </label>
		<input type="checkbox" id="enableNotifications"> <label> Enable notifications </label>
		</span>
		<div id="cryptoStatus"></div>
	</div>
	<div id = "msgInput">
		<div id="optionsToggle" title="Toggle options">ðŸ”¨</div>
		<textarea id="messageInput" placeholder="Message" type="text"></textarea>
		<button id="send">Send</button>
	</div>
	</div>
	</div>
	
	</div>
	<script>
	/* ---------------------- CONFIGURATION ------------------------*/
	var databaseUrl = 'https://antano-chatas.firebaseio.com/';
	var messagesLimit = 147; //how many messages to show
	var notificationsEnabled = true; //enables or disables desktop notifications globally
	var encVersion = 1;
	var encAlgorithm = 'AES-256-GCM';
	var encKdf = 'PBKDF2-SHA-256';
	var pbkdf2Iterations = 310000;
	var maxAcceptedPbkdf2Iterations = 400000; // reject attacker-supplied high iteration counts from remote payloads
	var persistTransformSalt = 'firebasechat-passphrase-persist-v1';
	var persistTransformIterations = 120000;
	var encSaltLengthBytes = 16;
	var encIvLengthBytes = 12;

	/* ------------------ END OF CONFIGURATION ---------------------*/
	
	var fb = new Firebase(databaseUrl);
	var fbQuery = fb.endAt().limitToLast(messagesLimit);
	var lastName = "";
	var notifyEnabled = false;
	var password;
	var passwordFallback;
	var encrypt = false;
	var supportsModernCrypto = !!(window.crypto && window.crypto.subtle && window.TextEncoder && window.TextDecoder);
	var decryptFailureCount = 0;
	var cryptoStatusMessage = "";
	var messageRenderQueue = Promise.resolve();
	var attachGeneration = 0;

	/******** UNREAD MESSAGE NOTIFICATION *********/
	var unreadMsgCount = 0;
	var hidden, visibilityChange;
	var title = "Chat";
	var notificationWarmupExpiresAt = 0;
	document.title = title;
	/**********************************************/

	$(function(){
		$("#enableEncryption").prop('checked', false);
		$('#persistPass').attr('title', 'Persist derived unlock secret (not raw passphrase)');
		$('#nameInput').val(localStorage.getItem("nickname"));
		var storedNotify = localStorage.getItem("enableNotifications");
		if (storedNotify === null) {
			notifyEnabled = notificationsEnabled;
		} else {
			notifyEnabled = storedNotify === "true";
		}
		$('#enableNotifications').prop('checked', notifyEnabled);

		fbAttach();
		/******** UNREAD MESSAGE NOTIFICATION *********/
		setupVisibilityProps();
		/**********************************************/
		if (hasPersistedSplitSecret())
		{
			$("#enableEncryption").prop('checked', true);
			enableEncryption();
		}
	});
	$('#enableNotifications').change(function(){
		notifyEnabled = $(this).prop('checked');
		localStorage.setItem("enableNotifications", notifyEnabled);
	});
	$('#nameInput').change(function(){localStorage.setItem("nickname", $(this).val());});
	$('#passwordInput').change(function(){
		$("#enableEncryption").prop('checked', false);
		encrypt = false;
		password = undefined;
		passwordFallback = undefined;
		$("#secureIcon").hide(1000);
	});
	$('#send').click(function(){send();});
	$('#persistPass').click(function(){
		persistDerivedSecret();
	});
	$("#optionsToggle").click(function() {
		$("#options").toggle("fast");
	});
	$("#enableEncryption").change(function() {
		if(this.checked) {
			enableEncryption();
		} else
		{
			encrypt = false;
			password = undefined;
			passwordFallback = undefined;
			$("#secureIcon").hide(1000);
		}
	});

	$('#messageInput').keydown(function (e) {
		if (e.keyCode == 13 && e.ctrlKey) {
			$('#messageInput').val($('#messageInput').val() + "\n");
		}
	});
	$('#messageInput').keypress(function (e) {
		if (e.keyCode == 13 && !e.ctrlKey) {
			send();
			return false;
		}
	});

	function renderCryptoStatus()
	{
		var msg = cryptoStatusMessage;
		if (!msg && decryptFailureCount > 0) {
			msg = decryptFailureCount + " encrypted message(s) could not be decrypted.";
		}
		if (msg) {
			$("#cryptoStatus").text(msg).show();
		} else {
			$("#cryptoStatus").hide().text("");
		}
	}

	function setCryptoStatusMessage(msg)
	{
		cryptoStatusMessage = msg || "";
		renderCryptoStatus();
	}

	function incrementDecryptFailure()
	{
		decryptFailureCount += 1;
		renderCryptoStatus();
	}

	function resetDecryptFailures()
	{
		decryptFailureCount = 0;
		renderCryptoStatus();
	}

	function hasPersistedSplitSecret()
	{
		return !!(localStorage.getItem("p") && window.location.hash);
	}

	function resolvePersistedSecret()
	{
		var localHalf = localStorage.getItem("p");
		var hashHalf = "";
		if (window.location.hash) {
			try {
				hashHalf = decodeURIComponent(window.location.hash.substring(1));
			} catch (err) {
				hashHalf = "";
			}
		}
		if (!localHalf || !hashHalf) {
			return "";
		}
		return localHalf + hashHalf;
	}

	async function resolveActivePassword()
	{
		var userpass = $('#passwordInput').val();
		if (userpass) {
			return {
				primary: await derivePersistedSecret(userpass),
				fallback: userpass
			};
		}
		var persistedSecret = resolvePersistedSecret();
		if (persistedSecret) {
			return {
				primary: persistedSecret,
				fallback: ""
			};
		}
		return null;
	}

	async function enableEncryption()
	{
		if (!supportsModernCrypto) {
			encrypt = false;
			password = undefined;
			passwordFallback = undefined;
			$("#enableEncryption").prop('checked', false);
			$("#secureIcon").hide(0);
			setCryptoStatusMessage("Modern encryption is not supported in this browser.");
			return;
		}

		try {
			var resolvedPassword = await resolveActivePassword();
			if (!resolvedPassword) {
				encrypt = false;
				password = undefined;
				passwordFallback = undefined;
				$("#enableEncryption").prop('checked', false);
				$("#secureIcon").hide(0);
				setCryptoStatusMessage("Enter an encryption password first.");
				return;
			}

			password = resolvedPassword.primary;
			passwordFallback = resolvedPassword.fallback || undefined;
			setCryptoStatusMessage("");
			resetDecryptFailures();
			$("#secureIcon").show(2200);
			fb.off();
			$('#messages').html('');
			encrypt = true;
			fbAttach();
		} catch (err) {
			console.log(err);
			encrypt = false;
			password = undefined;
			passwordFallback = undefined;
			$("#enableEncryption").prop('checked', false);
			$("#secureIcon").hide(0);
			setCryptoStatusMessage("Failed to initialize encryption.");
		}
	}

	function utf8ToBytes(txt)
	{
		return new TextEncoder().encode(txt);
	}

	function bytesToUtf8(bytes)
	{
		return new TextDecoder().decode(bytes);
	}

	function randomBytes(length)
	{
		var bytes = new Uint8Array(length);
		window.crypto.getRandomValues(bytes);
		return bytes;
	}

	function toBase64(bytes)
	{
		var binary = "";
		var chunkSize = 0x8000;
		for (var i = 0; i < bytes.length; i += chunkSize) {
			var chunk = bytes.subarray(i, i + chunkSize);
			binary += String.fromCharCode.apply(null, chunk);
		}
		return btoa(binary);
	}

	function fromBase64(base64)
	{
		var binary = atob(base64);
		var bytes = new Uint8Array(binary.length);
		for (var i = 0; i < binary.length; i++) {
			bytes[i] = binary.charCodeAt(i);
		}
		return bytes;
	}

	async function deriveAesKey(passphrase, saltBytes, iterations)
	{
		var keyMaterial = await window.crypto.subtle.importKey(
			'raw',
			utf8ToBytes(passphrase),
			'PBKDF2',
			false,
			['deriveKey']
		);
		return window.crypto.subtle.deriveKey(
			{
				name: 'PBKDF2',
				salt: saltBytes,
				iterations: iterations,
				hash: 'SHA-256'
			},
			keyMaterial,
			{
				name: 'AES-GCM',
				length: 256
			},
			false,
			['encrypt', 'decrypt']
		);
	}

	async function derivePersistedSecret(rawPassphrase)
	{
		var keyMaterial = await window.crypto.subtle.importKey(
			'raw',
			utf8ToBytes(rawPassphrase),
			'PBKDF2',
			false,
			['deriveBits']
		);
		var secretBits = await window.crypto.subtle.deriveBits(
			{
				name: 'PBKDF2',
				salt: utf8ToBytes(persistTransformSalt),
				iterations: persistTransformIterations,
				hash: 'SHA-256'
			},
			keyMaterial,
			256
		);
		return toBase64(new Uint8Array(secretBits));
	}

	async function persistDerivedSecret()
	{
		if (!supportsModernCrypto) {
			setCryptoStatusMessage("Modern encryption is not supported in this browser.");
			return;
		}
		try {
			var resolved = await resolveActivePassword();
			if (!resolved || !resolved.primary) {
				setCryptoStatusMessage("Enter an encryption password first.");
				return;
			}
			password = resolved.primary;
			passwordFallback = resolved.fallback || undefined;
			var half = Math.floor(password.length / 2);
			localStorage.setItem("p", password.substring(0, half));
			window.location.hash = encodeURIComponent(password.substring(half));
			setCryptoStatusMessage("Derived unlock secret persisted.");
		} catch (err) {
			console.log(err);
			setCryptoStatusMessage("Failed to persist unlock secret.");
		}
	}

	async function encryptTextV1(plainText, passphrase)
	{
		var salt = randomBytes(encSaltLengthBytes);
		var iv = randomBytes(encIvLengthBytes);
		var key = await deriveAesKey(passphrase, salt, pbkdf2Iterations);
		var encryptedBuffer = await window.crypto.subtle.encrypt(
			{ name: 'AES-GCM', iv: iv },
			key,
			utf8ToBytes(plainText)
		);
		return {
			text: "This message is encrypted",
			enc: {
				v: encVersion,
				alg: encAlgorithm,
				kdf: encKdf,
				iter: pbkdf2Iterations,
				salt: toBase64(salt),
				iv: toBase64(iv),
				ct: toBase64(new Uint8Array(encryptedBuffer))
			}
		};
	}

	async function decryptTextV1(encObj, passphrase)
	{
		if (!encObj || encObj.v !== encVersion || encObj.alg !== encAlgorithm || encObj.kdf !== encKdf) {
			throw new Error("Unsupported encryption payload");
		}
		var iterations = Number(encObj.iter);
		if (!isFinite(iterations) || iterations <= 0 || iterations !== Math.floor(iterations) || iterations > maxAcceptedPbkdf2Iterations) {
			throw new Error("Invalid KDF iteration count");
		}
		var salt = fromBase64(encObj.salt);
		var iv = fromBase64(encObj.iv);
		var ciphertext = fromBase64(encObj.ct);
		var key = await deriveAesKey(passphrase, salt, iterations);
		var decryptedBuffer = await window.crypto.subtle.decrypt(
			{ name: 'AES-GCM', iv: iv },
			key,
			ciphertext
		);
		return bytesToUtf8(new Uint8Array(decryptedBuffer));
	}

	async function processIncomingMessage(snapshot)
	{
		var message = snapshot.val();
		if (!message) {
			return;
		}

		var isEncrypted = false;
		if (message.enc) {
			isEncrypted = true;
			if (!password) {
				message.text = "Encrypted message. Enable encryption to decrypt.";
			} else {
				var decryptionCandidates = [password];
				if (passwordFallback && passwordFallback !== password) {
					decryptionCandidates.push(passwordFallback);
				}
				try {
					var decryptedText;
					var lastError;
					for (var i = 0; i < decryptionCandidates.length; i++) {
						try {
							decryptedText = await decryptTextV1(message.enc, decryptionCandidates[i]);
							break;
						} catch (candidateErr) {
							lastError = candidateErr;
						}
					}
					if (decryptedText === undefined) {
						throw lastError || new Error("Decryption failed");
					}
					message.text = decryptedText;
				} catch (err) {
					console.log(err);
					message.text = "Decryption failed (wrong password or corrupted data)";
					incrementDecryptFailure();
				}
			}
		} else if (message.ct) {
			isEncrypted = true;
			message.text = "Legacy encrypted message format is no longer supported.";
		}

		displayChatMessage(message.name, message.text, message._at, isEncrypted);
		/******** UNREAD MESSAGE NOTIFICATION *********/
		notifyAboutUnread(snapshot);
		/**********************************************/
		if (notifyEnabled && Date.now() >= notificationWarmupExpiresAt) {
			notify(message.name, message.text);
		}
		lastName = message.name;
	}

	function fbAttach()
	{
		attachGeneration += 1;
		var currentGeneration = attachGeneration;
		messageRenderQueue = Promise.resolve();
		notificationWarmupExpiresAt = Date.now() + 17000;
		fbQuery.on('child_added', function (snapshot) {
			if (currentGeneration !== attachGeneration) {
				return;
			}
			messageRenderQueue = messageRenderQueue
				.then(function () {
					if (currentGeneration !== attachGeneration) {
						return;
					}
					return processIncomingMessage(snapshot);
				})
				.catch(function (err) { console.log(err); });
		});
	}

	async function send()
	{
		var name = $('#nameInput').val();
		var text = $('#messageInput').val();
		if (!text)
			return;
		if (encrypt)
		{
			if (!supportsModernCrypto || !password) {
				setCryptoStatusMessage("Encryption is enabled but an active password is missing.");
				return;
			}
			try {
				var encryptedPayload = await encryptTextV1(text, password);
				fb.push({name: name, text: encryptedPayload.text, enc: encryptedPayload.enc, _at: new Date().toISOString()});
			} catch (err) {
				console.log(err);
				setCryptoStatusMessage("Failed to encrypt message.");
				return;
			}
		}
		else
		{
			fb.push({name : name, text : text, _at: new Date().toISOString()});
		}
		$('#messageInput').val('');
	}
	function displayChatMessage(name, text, time, encrypted) {
		var localTimeString = new Date(Date.parse(time)||time).toLocaleString("lt");
		var altClass="";
		var sameNickClass = "new";
		var encryptedClass = "enc";
		if (!encrypted)
			encryptedClass = "";
		if ($('#nameInput').val() != name)
			altClass = "alternate";
		if (lastName == name)
			sameNickClass = "same";
		text = formatText(text);
		var body  = $("<div class='msgBody col-md-11' />").html(text).append($('<p class="time" />').text(localTimeString));
		var textDiv= $('<div class="msg row '+altClass+' '+sameNickClass+' '+encryptedClass+'" />').html(body);
		textDiv = textDiv.prepend($('<div class="nickname col-md-1" />').text(name));
		
		body[0].querySelectorAll('pre code').forEach((block) => {
			hljs.highlightBlock(block);
		});
		textDiv.appendTo($('#messages'));
		$('#messages')[0].scrollTop = $('#messages')[0].scrollHeight;
	}

	function formatText(txt)
	{
		if (txt === null || txt === undefined) {
			return "";
		}
		txt = String(txt);
		if (txt.startsWith("`")) { //pre
			txt = txt.replace(/^`|`$/g, "");
			txt = txt.replace(/^\s+|\s+$/g, ''); //trim start
			return "<pre><code>"+escapeHtml(txt)+"</code></pre>";
		}
		txt = escapeHtml(txt);
		var codeExp = /`(.+?)`/gi;
		if (txt.search(codeExp) >= 0)
		{
			return txt.replace(codeExp, '<code class="snip">$1</code>');
		}
		var imgExp = /(\b(https?):.+?\.(jpg|gif|png|svg|jpeg))/gi;
		var linkExp = /(\b(https?):[^ ]+)/gi;
		txt = txt.split("\n").join("<br />");
		if (txt.search(imgExp) >= 0)
		{
			return txt.replace(imgExp, '<a href="$1" target="_blank"><img src="$1" /></a>');
		}
		txt = txt.replace(linkExp, '<a href="$1" target="_blank">$1</a>');
		return txt;
	}

	function escapeHtml(txt) {
		return txt
			.replace(/&/g, "&amp;")
			.replace(/</g, "&lt;")
			.replace(/>/g, "&gt;")
			.replace(/"/g, "&quot;")
			.replace(/'/g, "&#39;");
	}
	
	function notify(name, txt) {
		if (name == $('#nameInput').val())
			return;
		if (!("Notification" in window)) {
			alert("This browser does not support desktop notification");
		} else if (Notification.permission === "granted") {
			new Notification(txt);
		} else if (Notification.permission !== 'denied') {
			Notification.requestPermission(function (permission) {
				if (permission === "granted") {
					new Notification(txt);
				}
			});
		}
	}
	  
	/******** UNREAD MESSAGE NOTIFICATION *********/
	function setupVisibilityProps(){
		if (typeof document.hidden !== "undefined") {
		  hidden = "hidden";
		  visibilityChange = "visibilitychange";
		} else if (typeof document.mozHidden !== "undefined") {
		  hidden = "mozHidden";
		  visibilityChange = "mozvisibilitychange";
		} else if (typeof document.msHidden !== "undefined") {
		  hidden = "msHidden";
		  visibilityChange = "msvisibilitychange";
		} else if (typeof document.webkitHidden !== "undefined") {
		  hidden = "webkitHidden";
		  visibilityChange = "webkitvisibilitychange";
		}
		document.addEventListener(visibilityChange, onVisibilityChange, false);
	}

	function onVisibilityChange(){
		if (!document[hidden]) {
			unreadMsgCount = 0;
			document.title = title;
		}
	}

	function notifyAboutUnread(eventArgs) {
		if (document[hidden]) {
			unreadMsgCount += 1;
			document.title = '(' + unreadMsgCount + ') ' + title;
		}
	}

	function getParameterByName(name) {
	  name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
	  var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
	  results = regex.exec(location.search);
	  return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
	}
    </script>

<div id="secureIcon" style="display:none;"><img src="data:image/gif;base64,R0lGODlhIAAgAOZ/ANDt//+/ALKEMLiKM+X1/6anqOC9atXv/3WVvJVlPbLL483s/5lxUMfIx//EEpdoMN/z///GGoxbMfLy8oyXqur3/4Wjxu74/5q52eLWzMKniMKMG//MNNnw/7m3tf/ABMSVM8KXQ/e+Ga3J45eXl//UVJirx//IJqZzJfL6/7ORZsCql+z4///efdLIvrqhi//BCKmDY//CDP/cc7ucfUlnlf/AAv/aavT7///XYP/nov/RSI2szsKfYqyKZcKQKeDDgqnH46OBYrjN49mfEPe5BJaqx9GZE7uGH+i6Q7KAIpCtznd/jef2/+j2/+L0/+Hz/9zy/9vx/8GsmOjg2G15jdHBsvDq5djLv7qbcPDfuPj4+MKgasy+saS71erv8qx8LsmSFrOQYK+OcrSnmf/fgP/zz3yCjNm4c+CmDdTU1JFgL//KLJeEe8vU2MKdXK+afJ9vLoKGjKuMX//ghbqQRKfH48mtl9Le5aN6V7aXfff18v/HIPf8///OPf///yH5BAEAAH8ALAAAAAAgACAAAAf/gH+Cg3tYU1NWV4OLjI2Ney9ZQC05SSAqGY6ajVRCWjqUOxwnIkpje5ube0JmoDmiJxEOMkp5qZovn5Qhaz4gIjIwH3FtJsbHx0bKFhQNf3tZriEJmVQDwh9ECRN9ODgpKRfiFRVOTV5Mf1iTr3Eagy8fHwEBElje4OIX5OYEQ+lTQnF4cAfePHoopnwLN65cEwL+AL4a9SOGIGv0EC5JseRCxyUVljRZQuDJvz9WkoyStUEMjR9FMgZYs/FjSCcklzyBcvIKiFizsMkMkEbCR48hRxJYAgWCgnR/fIgIKm9oABQMxLHg97BkU6dQrwwIVnXoEQkuLmx1CHEnBAhR/54OsjKgrMyzNpfgXPpkCYQlUaTIHURFzJGY9IigSNBlCQuQInNC8btESofBi6gwEIBkgwQ9X5Dqzdn3b5QlHTqMgMpIww4Z9aao5dr2a+DUB1Y70lACtoQVa/t5fXu7w4HcrBfxhr1mBbnISyf/lYJ6yXHdjV7kcHA1RjnSlE93sG4dQJDkg6bc4I4ihjnJlKmPP7AEgHn0gqbMcGCjfVe3cFlm3HH23efIFGVEYIMSMdRGnIDHLWHBhBggIIcjWBigoBISkAHHHA0AVh19B1hg3wJ21ECCIxkYwMcHIWxnAxFGyUceACYusAACZ6jBogEnfFDHDREgsYYQI95ogXGOCFThgSYZoBHkBjNEgMIaeOBGoH1LNllAKm+w8cEGLUTgmQduHHdAgQtYwEMVBWyRSg8cwLABHS8WIQEDE7oZRBAY1OCknKlwUWcYPYCBAgp7FuBoARQwwQQJztzyhwp+wEBjJpZ2StcGa9DQaSOBAAA7" width="32" height="32" title="This chat is using encryption"></div>	
</body></html>
